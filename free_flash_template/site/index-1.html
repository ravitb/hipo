<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title></title>
<link type="text/css" rel="stylesheet" href="style.css" />
<style>
    .marked-element {
        outline: 1px dashed red;
    }

    .hidden {
        display: none;
    }

    .edit-window {
        position: absolute;
        top: -3000px;
        left: -3000px;
        min-width: 200px;
        min-height: 150px;
        background: #fff;
        border: 4px solid rgba(0,0,0,0.15);
    }

    .fake-btn {
        width: 80px;
        height: 40px;
        line-height: 44px;
        text-align: center;
        background-color: #67C9F0;
    }

    .content {
        display:inline-block;
        border: solid 1px #000;
        min-height: 200px;
        width: 300px;
    }
</style>
<script src="rollover.js" type="text/javascript"></script>
</head>
<body id="page_1" onload="MM_preloadImages('images/m_1_hov.gif','images/m_2_hov.gif','images/m_3_hov.gif','images/m_4_hov.gif','images/m_5_hov.gif')">
<div id="fake-body">
<div class="bgr">
	<table class="center_1">
        <tr>
          <td class="header">
            <div class="logo"><a href="index.html"><img src="images/logo.gif" alt="" /></a><br /></div>
                <img src="images/m_1_hov.gif" alt=" " width="179" height="58"  id="Image2" /><a href="index-2.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image3','','images/m_2_hov.gif',1)"><img src="images/m_2.gif" alt=" " width="146" height="58"  id="Image3" /></a><a href="index-3.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image4','','images/m_3_hov.gif',1)"><img src="images/m_3.gif" alt=" " width="145" height="58"  id="Image4" /></a><a href="index-4.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image5','','images/m_4_hov.gif',1)"><img src="images/m_4.gif" alt=" " width="137" height="58"  id="Image5" /></a><a href="index-5.html" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('Image6','','images/m_5_hov.gif',1)"><img src="images/m_5.gif" alt=" " width="156" height="58"  id="Image6" /></a><br /></td>
        </tr>
        <tr>
            <td class="content">
                <table class="h_table">
                    <tr>
                        <td class="column">
                        	<img src="images/spacer.gif" alt="" width="287" height="1" /><br /></td>
                        <td class="column_1">
                            	<div class="side_left">
                                	<div class="side_right">
                                    	<div class="side_top">
                                        	<div class="side_bot">
                                            	<div class="left_top">
                                                	<div class="right_top">
                                                    	<div class="left_bot">
                                                        	<div class="right_bot">
                                                            	<div class="h"><img src="images/2_h_1.gif" alt="" /><br /></div>
                                                            	<div class="indent txt">
                                                                	<strong>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. </strong>
                                                                    <div class="in5"></div>
                                                                    In consectetuer tincidunt lectus. Fusce orci felis, 
                                                                    molestie ut, ornare quis, rhoncus at, dolor.
                                                                    <div class="in15"></div>
                                                                    <img src="images/2_pic_1.jpg" alt="" /><br />
                                                                    <div class="in10"></div>
                                                                    Duis sit amet neque. Duis odio nulla, <strong class="txt_1">tincidunt sit amet,</strong> 
                                                                    vulpu- tate a, auctor et, tortor. Nulla sit amet lectus at 
                                                                    nunc lacinia laoreet am enim purus, cursus id, con- 
                                                                    sectetuer...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="link" href="#">read more</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div></td>
                      <td class="column_2">
                            <div class="h"><img src="images/2_h_2.gif" alt="" /><br /></div>
                            <div class="indent">
                                <strong class="txt_1">Praesent eget leo</strong><br />
                                Nulla dapibus massa. Curabitur mollis lacinia 
                                mauris. Phasellus rhoncus, sem vel tempus.<br /><br />
                                <strong class="txt_1">Rhoncus turpis metus</strong><br /> 
                                Convallis nibh, non elementum nunc orci ut nisl. 
                                Vivamus ven- enatis tristique quam.<br />
                                <br />
                                <strong class="txt_1">Donec non nunc</strong><br />
                                Morbi condimentum pede ut nunc. Sed sapien. 
                                Vivamus leo. Praese fermentum ultrices dui.<br /><br />
                                <strong class="txt_1">Mauris venenatis odio </strong><br />
                                At rutrum vestibulum, justo lacus suscipit 
                                nunc, at vehicula massa justo non sem. 
                            </div></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>
   <div class="footer">
   		Connect &copy; 2007 | <a href="index-6.html">Privacy Policy</a>
   </div>
</div>

<script src="../../jquery-2.1.1.min.js"></script>
<script src="../../jquery.ba-postmessage.js"></script>
<script src="../../tiny-draggable.js"></script>
<script>
    (function($) {

        window.ParadeSrc = {

            selectedElement: {},

            init: function() {

                var that = this;


                that.receiveMessage();
                that.selectToEdit();
                that.editWindow = this.initEditWindow();
            },

            initEditWindow: function() {

                var that  = this,
                    $popup = $('<div class="edit-window hidden"><span class="content" contenteditable="true"></span><div class="fake-btn">Save Me!</div></div>');


                that.getPropetyString = function($ele) {
                    var classNames = $ele.removeClass('marked-element').prop('class').split(' ').join('.'),
                        eleTagName = $ele.prop("tagName"),
                        index;

                    classNames = classNames.length ? '.' + classNames : '';
                    if (!$ele.siblings(eleTagName + classNames).length) {
                        return eleTagName + classNames;
                    } else {
                        return eleTagName + ':nth-of-type(' + $ele.index() + ')';
                    }
                }


                that.getElementRout = function($ele) {

                    // bi$('#main-wrapper > div.main-content:nth-of-type(2) > div.mp-box:nth-of-type(4) > div.box-row > ul.cf > li:nth-of-type(2) > p').html( 'Roger Ravit.<br>What do you do best? Create your Gig and start selling. It\'s free, and only takes 5 minutes.' );

                    var ancestry   = that.getPropetyString($ele),
                        $currentEle = $ele.parent();

                    while (!$currentEle.prop('id').length || !$currentEle.is('body')) {

                        ancestry = that.getPropetyString($currentEle) +'>'+ ancestry;
                        $currentEle = $currentEle.parent();
                    }

                    ancestry = ($currentEle.prop('id').length ? '#' + $currentEle.prop('id') : $currentEle.prop("tagName")) +'>'+ ancestry;

                    return ancestry;
                }

                $('body').append($popup);
                $popup.tinyDraggable();

                $('.fake-btn').on('click', function(e) {

                    var $ele     = $(this),
                        $content = $ele.siblings('.content');

                    that.selectedElement.text($content.text());

                    that.postMessage({
                        message: {
                            text: $content.text(),
                            rout: that.getElementRout(that.selectedElement)

                        },
                        destenation: '*'
                    });

                    $content.html('');
                    $popup.addClass('hidden');
                });

                return $popup;
            },

            selectToEdit: function($scope) {

                var that   = this,
                    $scope = $scope || $('* #fake-body *');

                $scope.on('mouseenter', function(e) {

                    $('body *').removeClass('marked-element');  
                    $(this).addClass('marked-element');

                    return false;
                }).on('mouseleave', function(e) {

                    $(this).removeClass('marked-element');

                    return false;
                }).on('click', function(e) {

                    var $ele = $(this),
                        px = $ele.offset().top + $ele.outerHeight() + 20,
                        py = $ele.offset().left;

                    that.selectedElement = $ele;

                    that.editWindow.css({top: px, left: py}).removeClass('hidden').find('.content').text($ele.html());

                    return false;
                });
            },

            postMessage: function(options) {

                var options = $.extend({message: this.selectToEdit, destination: '*'}, options);
                $.postMessage(
                    options.message,
                    options.destination
                );
            },

            receiveMessage: function() {

                $.receiveMessage(
                    function(e){
                        console.log('data childe', e.data );
                    },
                    function(param) {
                        return true;
                    }

                );
            }

        }

        $(document).ready(function() {
            ParadeSrc.init();
        });

    })($);



</script>
</body>
</html>
